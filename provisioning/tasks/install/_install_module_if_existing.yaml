- name: Check if module for current os and architecture exists
  stat:
    path: "tasks/install/{{ ansible_facts['os_family'] }}/{{ ansible_facts['machine'] }}/{{ module }}.yml"
  registe: module_result

- include_tasks:
    file: "tasks/install/{{ ansible_facts['os_family'] }}/{{ ansible_facts['machine'] }}/{{ module }}.yml"
  when: module_result.stat.exists